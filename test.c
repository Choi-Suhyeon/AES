#include <stdio.h>

// #define MUL2(x) (x << 1) ^ (x & 0x80 ? 0x1b : 0) // do not unerstand
// #define MUL3(x) (MUL2((x)) ^ (x))

inline unsigned char MUL2(unsigned char x) {
    //printf("%#x\n", x & 0x80);
    return (x << 1) ^ (x & 0x80 ? 0x11B : 0);
}

typedef unsigned char byte;

int main(void) {
    byte stt[16] = { 
        0x00, 0x01, 0x02, 0x03,
        0x04, 0x05, 0x06, 0x07,
        0x08, 0x09, 0x0A, 0x0B,
        0x0C, 0x0D, 0x0E, 0x0F,
    };
    
    byte key[17] = {
        0x1, 0x1, 0x1, 0x1,
        0x1, 0x1, 0x1, 0x1,
        0x1, 0x1, 0x1, 0x1,
        0x1, 0x1, 0x1, 0x1,
    };

    byte tmp[2] = { 0xD4, 0xE0 };

    // printf("0x%X\n", MUL2(tmp[0]) ^ MUL3(tmp[1]) ^ 0xB8 ^ 0x1E);
    printf("0x%X\n", MUL2(tmp[0]));
    // printf("0x%X\n", MUL3(tmp[1]));

    return 0;
}